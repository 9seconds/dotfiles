#!/usr/bin/env bash
#
set -eu -o pipefail

#
#  Switch git branches
#

git branch --color=always --sort=-committerdate \
  | grep -v '[*+]' \
  | fzf --filter "${1:-}" --no-sort \
  | git fzf \
      -p Branch \
      -v 'git show --format=medium --no-patch {..} | bat -p -l "Git Log" --color=always' \
  | xargs -r git switch
